<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

</head>
<body>
<h1>지도를 그리자</h1>
<hr>
<button id="myhome">우리집</button>
<button id="myfavourite">내가 좋아하는 곳</button>
<hr>
<div id="map" style="width:800px;height:500px;"></div>
<script  src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1cc2187c8717ffab77eb12ceab5806ae"></script>
<script>
let myHomeButton = document.querySelector('#myhome');
let myFavButton = document.querySelector('#myfavourite');
const container = document.getElementById('map');
/* let latitude;
let longitude; */
let map;
let options;

myHomeButton.addEventListener('click', function(){
	drawMap(37.534925, 126.658113, '여기가 우리집~~!!', '#26cbff', true);
	
	
});

myFavButton.addEventListener('click', function(){
	drawMap(37.537578, 126.616487, '내가 좋아하는곳...캠핑장!!!', '#ff5626', false);
});

function drawMap(latitude, longitude, message, color, isHome){
	let moveLatLng = new kakao.maps.LatLng(latitude, longitude)
	if(map != undefined){
		map.jump(moveLatLng, 4, {
			animate : {
				duration : 1000
			}
		});
	}else{
		options = {
				center: moveLatLng,
				level: 4
		};
		map = new kakao.maps.Map(container, options);
	}
	
	
	let imageSrc = isHome ? 'https://cdn-icons-png.flaticon.com/512/25/25694.png' : 'https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678087-heart-512.png',    
		imageSize = new kakao.maps.Size(30, 30), // 마커이미지의 크기입니다
		imageOption = {
			
	}; 

	let markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize,
			imageOption)

	// 마커를 표시할 위치입니다 
	let position = new kakao.maps.LatLng(latitude, longitude);
	
	// 마커를 생성합니다
	let marker = new kakao.maps.Marker({
		position : position,
		image : markerImage,
		clickable : true
	});
	marker.setMap(map);
	let iwContent = `<div id="iwc" style="border:none;color:white;border-radius:8px;padding:8px;background-color:${color};font-weight:bold;">${message}</div>`;
	let iwRemoveable = true; 
	
	let infowindow = new kakao.maps.InfoWindow({
		content : iwContent,
		removable : iwRemoveable
	});

	kakao.maps.event.addListener(marker, 'click', function() {
		infowindow.open(map, marker);
		let allDivs = document.querySelectorAll("div");
		let desiredDivIndex = 0;
		for(let i in allDivs){
			if(allDivs[i].id == 'iwc')
				desiredDivIndex = i-3;
		}
		allDivs[desiredDivIndex].style.border = 'none';
		allDivs[desiredDivIndex].style.background = 'none';
		//allDivs[desiredDivIndex+1].style.background = color;
	});
	
	
	
	
}





</script>
   
</body>
</html>